<% include ../partials/header %>

<div class="container">
    <h1>Booking System <br /><small>Welcome <%= user.firstName %> <%= user.lastName %></small></h1>
</div>
<div class="container">
    <h3>Registered users</h3>
    <div class="row">
        <div class="table-responsive col-md-10 col-md-offset-1 panel panel-default">
            <div class="panel-body">
                <table class="table table-hover table-striped">
                    <thead>
                        <th>Last Name</th>
                        <th>First Name</th>
                        <th>Email Address</th>
                        <th>Department</th>
                        <th colspan="2">&nbsp;</th>
                    </thead>
                    <tbody>
                        <% registeredUsers.forEach(function(registeredUser){ /* loop through all registered users in the system */ %>
                            <tr>
                                <td>
                                    <p><%= registeredUser.lastName %></p>  
                                </td>
                                <td>
                                    <p><%= registeredUser.firstName %></p>    
                                </td>
                                <td>
                                    <p><%= registeredUser.email %></p>    
                                </td>
                                <td>
                                    <p><%= registeredUser.department %></p>    
                                </td>
                                <td>
                                    <a href="mailto:<%= registeredUser.email %>"><span class="glyphicon glyphicon-envelope btn btn-default btn-sm" aria-hidden="true"></span></a>    
                                </td>
                                <td>
                                    <% if(user.email === registeredUser.email) { /* if we click on ourself we want our user page */ %>
                                        <a href="/user/<%= user._id %>"><span class="glyphicon glyphicon-calendar btn btn-default btn-sm" aria-hidden="true"></span></a> 
                                    <% } else { /* if we click another user we want their registered user page instead */ %>
                                        <a href="/user/<%= user._id %>/registered/<%= registeredUser._id %>"><span class="glyphicon glyphicon-calendar btn btn-default btn-sm" aria-hidden="true"></span></a> 
                                    <% } %> 
                                </td>
                            </tr>
                        <% }); %>
                    </tbody>    
                </table>                    
            </div>
        </div>            
    </div>
</div>

<% include ../partials/footer %>
